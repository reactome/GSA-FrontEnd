<div class="container" #root>
  <table (mousedown)="mousedown($event)" (mouseup)="mouseup()" (mouseover)="mousemove($event)"
         (keydown)="navigateTableDefault($event)">
    <div *ngIf="settings.show_cols">{{settings.show_cols}}
      <thead>
      <tr>
        <th style="z-index: 2000;"></th>
        <th class="columns" *ngFor="let col of settings.columns; let y = index" [attr.y]="y" [attr.x]="-1">
          <div class="title-container">
            {{col}}
            <button class="bin-button" mat-icon-button (click)="deleteColumn($event, y)" color="primary">
              <span class="material-icons">delete</span>
            </button>
          </div>
        </th>
        <th *ngIf="settings.addColumnButton" class="background-white no-border"></th>


      </tr>
      </thead>
    </div>
    <tbody>
    <tr *ngFor="let row of settings.rows; let x = index">
      <th *ngIf="settings.show_rows" class="rows" [attr.x]="x" [attr.y]="-1">{{row}}</th>
      <td *ngFor="let rowVal of settings.data[x]; let y = index" [attr.x]="x" [attr.y]="y">
        {{rowVal.value}}
      </td>
      <td *ngIf="x===0 && settings.addColumnButton" rowspan="0" height="100px" style="padding:0px">
        <button #addCol mat-raised-button style="width:100%;height:100%;margin: 0px" color="primary"
                (click)="addColumn()">
          Add column
        </button>
      </td>
    </tr>
    </tbody>
  </table>
  <input #flyingRename class="flying-rename cursor-visible" (change)="renameCell()" (blur)="renameCell()"
         *ngIf="renameVisible" [(ngModel)]="renameValue" [ngModelOptions]="{standalone: true}"
         (keydown.arrowUp)="navigateTableInput($event)" (keydown.arrowDown)="navigateTableInput($event)"
         (keydown.arrowLeft)="navigateTableInput($event)" (keydown.delete)="deleteMarkedArea($event)"
         (keydown.arrowRight)="navigateTableInput($event)" (keydown.tab)="navigateTableInput($event)"
         (keydown.shift.tab)="navigateTableInput($event)"
         (paste)="pasteValues($event)" (copy)="copyValues($event)"
         (mouseup)="mouseup()" (mouseover)="mousemove($event)"
         [style.left.px]="modifiedCell.coordinate.x" [style.top.px]="modifiedCell.coordinate.y"
         [style.width.px]="modifiedCell.coordinate.width - 12" [style.height.px]="modifiedCell.coordinate.height - 1">
</div>

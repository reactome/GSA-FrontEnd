<div #root class="container">
  <table (keydown)="navigateTableDefault()" (mousedown)="mousedown($event)" (mouseover)="mousemove($event)"
         (mouseup)="mouseup()">
    <thead *ngIf="settings.showCols">
    <tr>
      <th></th>
      <th *ngFor="let col of settings.columns; let x = index" [attr.x]="x" [attr.y]="-1" class="columns">
        <div [attr.x]="x" [attr.y]="-1" class="title-container">
          {{col}}
          <button (click)="deleteColumn($event, x)" [attr.addCol]="true" class="bin-button" color="primary"
                  mat-icon-button>
            <span class="material-icons">delete</span>
          </button>
        </div>
      </th>
      <th *ngIf="settings.addColumnButton" class="background-white no-border"></th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let row of settings.rows; let y = index">
      <th *ngIf="settings.showRows" [attr.x]="-1" [attr.y]="y" class="rows">{{row}}</th>
      <td *ngFor="let rowVal of settings.data[y]; let x = index" [attr.x]="x" [attr.y]="y">
        {{rowVal.value}}
      </td>
      <td *ngIf="y===0 && settings.addColumnButton" height="100px" rowspan="0" style="padding:0px">
        <button #addCol (click)="addColumn()" color="primary"
                mat-stroked-button
                style="width:100%;height:100%;margin: 0px; border-radius: 0px">
          Add column
        </button>
      </td>
    </tr>
    </tbody>
  </table>
  <input #flyingRename (blur)="renameCell()" (change)="renameCell()" (copy)="copyValues()"
         (keydown.arrowDown)="navigateTableInput($event)" (keydown.arrowLeft)="navigateTableInput($event)"
         (keydown.arrowRight)="navigateTableInput($event)"
         (keydown.arrowUp)="navigateTableInput($event)" (keydown.delete)="deleteSelectedArea()"
         (keydown.enter)="navigateTableInput($event)" (keydown.shift.tab)="navigateTableInput($event)"
         (keydown.tab)="navigateTableInput($event)"
         (mouseover)="mousemove($event)" (mouseup)="mouseup()"
         (paste)="pasteValues($event)"
         *ngIf="renameVisible" [(ngModel)]="renameValue"
         [ngModelOptions]="{standalone: true}" [style.height.px]="firstSelected.coordinate.height - 1"
         [style.left.px]="firstSelected.coordinate.x" [style.top.px]="firstSelected.coordinate.y"
         [style.width.px]="firstSelected.coordinate.width - 12" class="flying-rename cursor-visible">
</div>
